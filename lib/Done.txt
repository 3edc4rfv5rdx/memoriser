  + Sound system review and fixes
    - Deduplicated getDefaultSound/getDefaultDailySound: shared companion functions in NotificationService
    - Removed ~120 lines of duplicate code (save/get functions in NotificationReceiver)
    - Added system fallback for one-time default sound (was returning null, now falls back to TYPE_ALARM)
    - Fixed "Sound:" in locales.json: removed colon from locale string, added programmatically in code
  + Request battery optimization exemption on app start (soft dialog)
    - Shows friendly AlertDialog explaining why background work is needed
    - Localized title/message/buttons via locales.json (ru, ua)
    - "Allow" button opens system ACTION_REQUEST_IGNORE_BATTERY_OPTIMIZATIONS
    - "Not now" button saves decline to SharedPreferences (won't ask again)
    - Skips dialog if already exempted or previously declined
    - Added REQUEST_IGNORE_BATTERY_OPTIMIZATIONS permission to AndroidManifest.xml
    - Added translateKey() helper in MainActivity for locales.json access
  + Force alarm sound through built-in speaker when Bluetooth is connected
    - Used MediaPlayer.setPreferredDevice(TYPE_BUILTIN_SPEAKER) in all alarm sound playback
    - FullScreenAlertActivity.playSound(): added setPreferredDevice to force speaker
    - NotificationSystem.playSoundFile() ‚Üí playSoundThroughSpeaker(): universal function for files and URIs
    - Disabled notification channel sounds (setSound(null,null)) on all channels
    - All notification sounds now played manually via playSoundThroughSpeaker() with forced speaker
    - Affects: fullscreen alerts, daily notifications, one-time reminders, period reminders
    - Removed getSoundUri() (no longer needed)
  + Full backup: include settings.db in backup/restore
    - Backup saves settings-{date}.db alongside memorizer-{date}.db
    - Restore finds settings DB in backup dir, closes settDb, copies, reopens
    - Preserves default sounds, theme, language and all other settings
  + Fix period sound: load default sound from settings into form when selecting Period type
    - Added getDefaultSound() method to Flutter (reminders.dart) and Android (NotificationService)
    - Period onTap now loads default sound via SimpleNotifications.getDefaultSound()
  + Period fullscreen alert: "Continue" / "Done" buttons for period reminders:
    - Auto-set fullscreen=true when user selects Period type in additem.dart
    - New layout: period_section with Continue (200dp) and Done (120dp) buttons, hidden by default
    - handlePeriodReminder passes isPeriod + isMonthlyPeriod flags to launchFullscreenAlert
    - launchFullscreenAlert forwards isPeriod/isMonthlyPeriod + translated labels via intent extras
    - FullScreenAlertActivity: if isPeriod, hides snooze_section, shows period_section
    - "Continue" dismisses alert (alarms continue next day)
    - "Done" calls completePeriodReminder: cancels all period alarms for item; date-based periods set active=0, monthly periods keep active=1
    - Added "Continue"/"Done" to locales.json (ru, ua)
  + Fix period reminders not firing:
    - isItemStillActive() checked only remind==1, now also checks period==1
    - requestCode collision: same day in different months (e.g. Feb 13 & Mar 13) overwrote each other. Changed from itemId*100+day to itemId*10000+month*100+day
    - Samsung Freecess blocks setExactAndAllowWhileIdle: switched to setAlarmClock (same as daily reminders)
    - handlePeriodReminder used getDefaultSound instead of itemData.sound: now uses item's custom sound with fallback to default
  + Add sound selector to Period reminder form (uses 'sound' field, same as one-time reminders)
  + Fix notes sorting: sort by date field (if present) with "Newest first" setting, no-date items go to bottom sorted alphabetically by title
  + Move Periods folder to 3rd position in folder list (Notes ‚Üí Daily ‚Üí Periods ‚Üí Monthly ‚Üí Yearly)
  + Period reminders: new reminder type with date range + weekday filter:
    - DB migration v15: added period (0/1), period_to (INT), period_days (INT bitmask) to items
    - Reminder type toggle: changed from 2 horizontal to 3 vertical buttons (One-time, Daily, Period)
    - Period UI section: From/To text fields with calendar icons, time picker, weekday selector
    - Smart format: first field determines second field format (day-of-month 1-31 or full date YYYYMMDD)
    - Validation: both dates must be same format, both required, time required, at least one day
    - Scheduling: Flutter calculates all valid dates, schedules each via platform channel
    - Monthly periods (values 1-31): schedules current month + next month
    - One-time periods (full dates): schedules all days in range
    - requestCode = itemId * 100 + dayOfMonth for unique alarm IDs
    - PERIOD_REMINDER action in NotificationSystem.kt with full handler
    - BootReceiver support: reschedules period reminders after reboot
    - rescheduleAllReminders includes period reminders
    - Cancel period reminders on item delete (all 3 delete paths)
    - CSV backup/restore: added period fields to integer parsing
    - Localization: added Period, From, To, day, validation messages (ru, ua)
    - Periods virtual folder on main screen (ID: -6, teal color, date_range icon)
    - Period items filtered from main list and notes folder
    - Period folder sorting: by date (from) ASC, then time ASC
    - Period item subtitle: date range (From ‚Äî To), time, weekday compact string
    - Standard date/time row hidden for period items (replaced by period-specific display)
    - Toggle active: reschedules/cancels period reminders via updatePeriodReminders
    - Back button, title bar, empty state text support for period folder
    - All folder enter methods reset _isInPeriodFolder (mutual exclusion)
    - Localization: "No period reminders yet." (ru, ua)

  + Fullscreen alert: "Postpone 1 day" button (not shown for daily reminders):
    - Added "day" locale key (ru: "–¥–µ–Ω—å", ua: "–¥–µ–Ω—å") in locales.json
    - Added postpone_1day button in activity_fullscreen_alert.xml (150dp wide, between snooze row 2 and OK)
    - FullScreenAlertActivity reads isDaily flag from intent; hides button when isDaily=true
    - Button text set to "1 {day}" using translated label
    - OnClick: calls snoozeReminder with 1440 minutes (24 hours)
    - launchFullscreenAlert() in NotificationSystem.kt: added isDaily parameter (default false)
    - Passes label_day and isDaily extras to the fullscreen intent
    - handleDailyReminder passes isDaily=true; specific and snoozed reminders use default false

  + Wake screen on reminder trigger (non-fullscreen):
    - Added wakeScreen() in NotificationReceiver using PowerManager
    - SCREEN_BRIGHT_WAKE_LOCK + ACQUIRE_CAUSES_WAKEUP + ON_AFTER_RELEASE
    - Wakes screen for 3 seconds, only if screen is off (isInteractive check)
    - Called from handleDailyReminder and handleSpecificReminder (non-fullscreen branch)
    - Fullscreen alerts already wake screen via FullScreenAlertActivity flags
    - File: NotificationSystem.kt

  + Fix photo/sounds restore from backup:
    - Problem: FilePicker on Android returns cached copy of .db file, so parent dir
      points to cache instead of actual backup directory containing Photo/ and Sounds/
    - Fix: check if Photo/Sounds exist in picked parent; if not, extract date from
      filename (memorizer-YYYYMMDD.db) and look for mem-YYYYMMDD dir in Memorizer folder
    - Added logging to _copyDirectoryRecursive: source/target paths, source existence
      check, entity count for tracing
    - File: backup.dart

  + Localize day names: replaced hardcoded dayNames/dayNamesRu arrays with lw() keys
    - Added 7 locale keys (Mo..Su) to locales.json with ru/ua translations
    - getDayName() now uses lw(dayKeys[i]) instead of hardcoded arrays
    - getDaysCompact() takes first letter of localized day name
    - Removed const dayNames and dayNamesRu arrays from globals.dart

  + Monthly reminders: fixed month overflow bug:
    - Problem: 30 Jan + 1 month = 2 Mar (instead of 28 Feb)
    - Calendar.add(MONTH) + set(DAY_OF_MONTH) overflows invalid days
    - Solution: use getActualMaximum(DAY_OF_MONTH) to get max day in target month
    - Use min(originalDay, maxDayInMonth) for target day
    - Fixed in rescheduleRecurringReminder() for auto-reschedule after trigger
    - Fixed in BootReceiver monthly section for recovery after reboot
    - Now: 30 Jan -> 28 Feb (or 29 in leap year)
    - Now: 31 Jan -> 28/29/30 Feb depending on month

  + Auto-reschedule monthly/yearly reminders after trigger:
    - Extended ItemData with yearly, monthly, date, time fields
    - Modified getItemData() to query yearly, monthly, date, time from DB
    - Added rescheduleRecurringReminder() method in NotificationReceiver
    - Yearly reminders: schedule for same month/day next year
    - Monthly reminders: schedule for same day next month
    - Updates date in DB after rescheduling (for correct boot recovery)
    - Inline alarm scheduling (no external method dependency)
    - Handles calendar edge cases (month overflow, invalid dates)

  + UI improvements - compact form layout:
    - Tags/Date/Time fields: inline buttons via suffixIcon (stretch to right edge)
    - Priority redesigned: single line "Priority - X +" layout
      * Removed stars display and "(0-3)" from label
      * Label + buttons in one Row with spacing
    - Active checkbox: moved below "Reminder" header (separate line)
      * Shows only when reminder enabled
      * Green color for visual distinction
      * Saves to DB 'active' field
    - Reminder checkboxes reordered (one-time):
      * Fullscreen alert (first)
      * Monthly repeat
      * Yearly repeat
      * Remove after reminder (last)
      * Reduced spacing between checkboxes (10px -> 4px)
    - Removed fullscreen icon after "Fullscreen alert" text

  + Daily reminders compact layout:
    - Times section: center-aligned with offset (+40px left, +40px right balance)
      * Highlighted (+) button with background circle
      * Increased button size (24px -> 28px)
    - Days section: center-aligned with offset (+40px left, +40px right balance)
      * "All"/"Weekdays" buttons balanced
      * Checkmarks made bolder (Icons.done, size 22, weight 700)
    - Sound selector: reduced height and shifted right
      * Padding reduced (vertical 8px -> 6px)
      * Left edge shifted right (+16px)
      * Icon and selector more compact

  + Translations:
    - Added "Priority" -> ru: "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç", ua: "–ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç"
    - Added "Active" -> ru: "–ê–∫—Ç–∏–≤–Ω–æ–µ", ua: "–ê–∫—Ç–∏–≤–Ω–µ"
    - Removed obsolete "Priority (0-3)" translation

  + Active flag for reminders (quick enable/disable):
    - Per-item "active" flag with checkbox on main screen
    - DB version 14: 'active' column (INTEGER DEFAULT 1)
    - Checkbox displayed in leading area for items with any reminder type
    - Green checkbox appears left of title (not conflicting with priority stars)
    - Priority stars moved to title row on right side
    - Toggle changes 'active' field in database
    - NotificationSystem checks active flag before showing notification/alert
    - Inactive reminders (active=0) are skipped silently
    - Reschedules next occurrence for daily reminders even when inactive
    - Works for all reminder types: one-time, daily, monthly, yearly
    - Localization: ru/ua for "Reminder activated", "Reminder deactivated"

  + Fullscreen alert redesign (draggable circle barrier):
    - Layout: 1/8 (Memorizer+time) + 6/8 (content raised) + 1/8 (OK button)
    - Text split into 3 lines with increasing size:
      * Line 1: "Reminder:" label (18sp)
      * Line 2: Title (26sp bold)
      * Line 3: Content (30sp) - largest
    - Draggable circle barrier (200dp diameter, #AA000000)
      * Semi-transparent black oval with lock emoji üîí and wide down arrow
      * Positioned higher (150dp from top) instead of center
      * Drag gesture: must drag down 400+ pixels to dismiss
      * Snap back animation if drag < 400px
    - Full-screen semi-transparent barrier overlay (#66000000)
      * Blocks all clicks to OK button until circle dismissed
      * Both overlay and circle fade out together when threshold reached
    - Wide vector arrow drawable (ic_arrow_down_wide.xml) instead of emoji
    - Touch listener removed after dismissal to stop consuming events
    - Title no longer includes "Reminder:" prefix (now separate line)

  + Bug fixes:
    - Settings sound picker: Added missing custom sounds section and "Choose file" option
      * Import file_picker in settings.dart
      * Added getCustomSounds() call and custom sounds list in dialog
      * Added _pickSoundFile() function with FilePicker integration
      * Copies selected file to Sounds directory via copySoundFile()
    - Camera/gallery photo capture: Fixed Permission denied error
      * Modified getDocumentsDirectory() with fallback to app-specific storage
      * Added try/catch with write access test to Documents/Memorizer/Photo
      * Falls back to getApplicationDocumentsDirectory() on permission denial
      * Added requestLegacyExternalStorage/preserveLegacyExternalStorage to manifest
      * Added detailed logging in _takePicture() for debugging
    - Fullscreen alert OK button: Fixed accessibility without barrier dismissal
      * Added full-screen barrier overlay (clickable/focusable) to block button
      * Draggable circle set to non-clickable/non-focusable
      * OK button only accessible after circle dragged and barriers dismissed

  + Fullscreen alert windows for reminders:
    - Per-item checkbox "Fullscreen alert" in reminder section
    - DB version 13: 'fullscreen' column (INTEGER DEFAULT 0)
    - Launches fullscreen activity instead of notification when enabled
    - Works with all reminder types: one-time, daily, monthly, yearly
    - Orange fullscreen window (#FB8500) with title + content
    - Sound plays ONCE in Activity via MediaPlayer (USAGE_ALARM)
    - Swipe-down barrier overlay prevents accidental dismissal
    - Semi-transparent black overlay (#AA000000) with hint text
    - Gesture detector: swipe down (500+ pixels/sec) dismisses barrier
    - [OK] button accessible only after barrier dismissed
    - Back button disabled (user must swipe + tap OK)
    - Displays over lock screen (FLAG_SHOW_WHEN_LOCKED, FLAG_TURN_SCREEN_ON)
    - FullScreenAlertActivity.kt: Core activity with barrier + sound
    - activity_fullscreen_alert.xml: Layout with barrier overlay
    - NotificationSystem: Uses full-screen intent via notification
    - Permission: USE_FULL_SCREEN_INTENT (Android 10+)
    - targetSdkVersion 28: Avoids Android 10+ BAL restrictions
    - Auto-opens on lock screen without user permission
    - Notification auto-cancelled when fullscreen opens
    - Localization: ru/ua for "Fullscreen alert"
    - Testing: Works on emulator when screen is locked (keyevent 26)

  + Copy item feature:
    - "Copy" option in context menu (long press item)
    - Creates duplicate with "copy-" prefix (e.g., "aaa" ‚Üí "copy-aaa")
    - Copies all fields: content, tags, priority, date, time, remind settings
    - Copies and reschedules: one-time reminders, yearly, monthly, daily
    - Photos NOT copied (user can add manually)
    - Localizations: ru/ua for "Copy", "Item copied", "Failed to copy item"

  + Hide photo frame by default (show on [+] button):
    - Photo section hidden by default for new items
    - Shows compact [+] button to activate photo section
    - Auto-shows when editing item with existing photos
    - Auto-shows after adding photos (camera or gallery)
    - State variable _showPhotoSection controls visibility
    - Cleaner UI for items without photos

  + Fixed: Decode hidden items in notifications:
    - Added deobfuscateText() function in Kotlin (NotificationSystem.kt)
    - getItemData() now reads 'hidden' column from database
    - Hidden items (hidden = 1) are automatically decoded for notifications
    - Base64 decoding works for both one-time and daily reminders
    - Users now see readable text in notifications instead of base64 strings

  + Monthly repeating reminders:
    - Auto-reschedule to next month after date passes (like yearly events)
    - DB version 12: 'monthly' column (INTEGER DEFAULT 0)
    - updateMonthlyEvents() function handles month-end edge cases
    - Day 31 ‚Üí last day of month (Feb 28/29, Apr 30, etc.)
    - Year rollover support (Dec ‚Üí Jan next year)
    - Leap year detection for February dates
    - UI: Monthly checkbox (purple, Icons.calendar_month) above Yearly
    - Mutually exclusive with Yearly and "Remove after reminder"
    - Virtual folder: "Monthly Events" (ID: -5, purple color)
    - Display: üìÖ emoji prefix for monthly items
    - Filter logic excludes monthly from main list
    - Navigation: enter/exit folder, back button, AppBar title
    - Localizations: "Monthly repeat", "Monthly Events", "Monthly" (ru/ua)

  + Custom sound files for daily reminders:
    - File picker for mp3, wav, ogg, m4a, aac
    - Files copied to app-private storage (no permissions needed)
    - Sound picker shows: Default, Custom sounds, Choose file, System sounds
    - Kotlin: playSoundFile() via MediaPlayer (channel sounds don't work with file:// URIs)
    - Backup/Restore includes Sounds folder
    - Localizations: ru/ua

  + Default sound settings in Settings screen:
    - Default sound for one-time reminders
    - Default sound for daily reminders
    - Sound picker dialog with preview (play button)
    - Settings: "Default sound", "Default daily sound"
    - Saved to settingsDb
    - Localizations: ru/ua

  + Sound selection for reminders:
    - System notification and alarm sounds available
    - Sound picker dialog with preview (play button)
    - Separate sound fields: 'sound' for one-time, 'daily_sound' for daily
    - DB version 11 with 'sound' field
    - Kotlin: getSystemSounds(), playSound(), stopSound()
    - Flutter: SimpleNotifications methods for sounds
    - Architecture supports future external file playback

  + Daily Reminders virtual folder:
    - Shows items with daily = 1 in separate folder
    - Orange color, Icons.today icon
    - ID: -4 (virtual item)
    - Displayed at end of list after Yearly and Notes
    - Navigation: enter/exit, back button, AppBar title
    - Localizations: ru/ua

  + Multi-photo support (up to 10 photos per item):
    - Photos stored in Photo/item_ID/ folders
    - New item: temp_XXX folder ‚Üí moved to item_ID on save, deleted on cancel
    - Gallery view with PageView and indicators
    - Badge with photo count in list
    - Source: camera or gallery (multi-select)
    - Backup/Restore includes Photo folder
    - Migration v9: old photos ‚Üí item_ID
    - Cleanup orphaned temp folders on startup (older than 1 day)
